SQL
```SQL
-- 1. 현재 시간을 조회한다.
SELECT SYSDATE 
	FROM DUAL
;
-- 2. 현재 시간을 "연-월-일" 포멧으로 조회한다.
SELECT TO_CHAR(SYSDATE,' YYYY / MM / DD') 
	FROM DUAL
;
-- 3. 한 시간 전 시간을 "시:분:초" 포멧으로 조회한다.
SELECT TO_CHAR(SYSDATE ,' hh : mi : SS'), 
		TO_CHAR(SYSDATE,' hh24 : mi : SS')
	FROM DUAL
;
-- 4. EMPLOYEES 테이블의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
;
 -- 5. DEPARTMENTS 테이블의 모든 정보를 조회한다.
SELECT * 
	FROM DEPARTMENTS
;
-- 6. JOBS 테이블의 모든 정보를 조회한다.
SELECT  * 
	FROM  JOBS
;
 -- 6. JOBS 테이블의 모든 정보를 조회한다.====
SELECT  * 
	FROM  JOBS
;
-- 7. LOCATIONS 테이블의 모든 정보를 조회한다.
SELECT  * 
	FROM LOCATIONS
;
-- 8. COUNTRIES 테이블의 모든 정보를 조회한다.
SELECT  * 
	FROM COUNTRIES
;
-- 9. REGIONS 테이블의 모든 정보를 조회한다.
SELECT * 
	FROM REGIONS
;
-- 10. JOB_HISTORY 테이블의 모든 정보를 조회한다.
SELECT * 
	FROM JOB_HISTORY
;
-- 11. 90번 부서에서 근무하는 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES 
	WHERE DEPARTMENT_ID = 90
;
-- 12. 90번, 100번 부서에서 근무하는 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES 
	WHERE DEPARTMENT_ID = 90 
		OR DEPARTMENT_ID = 100
;
-- 13. 100번 상사의 직속 부하직원의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES 
	WHERE MANAGER_ID =100
;
-- 14. 직무 아이디가 AD_VP 인 사원의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES WHERE JOB_ID = 'AD_VP'
;
-- 15. 연봉이 7000 이상인 사원의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES 
	WHERE EMPLOYEES.SALARY >=7000
;
-- 16. 2005년 09월에 입사한 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES 
	WHERE EMPLOYEES.HIRE_DATE  >= TO_DATE ('2005 , 09 ,01','YYYY-MM-DD')
         and EMPLOYEES.HIRE_DATE  < TO_DATE ('2005 , 10 ,01','YYYY-MM-DD')
;
-- 17. 111번 사원의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
	WHERE e.EMPLOYEE_ID = 111
;
-- 18. 인센티브를 안받는 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
	WHERE e.COMMISSION_PCT IS NULL
;
-- 19. 인센티브를 받는 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
	WHERE e.COMMISSION_PCT IS NOT NULL
;
-- 20. 이름의 첫 글자가 'D' 인 사원들의 모든 정보를 조회한다
SELECT * 
	FROM EMPLOYEES e
	WHERE e.LAST_NAME LIKE 'D%'
;
-- 21. 성의 마지막 글자가 'a' 인 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
	WHERE e.FIRST_NAME LIKE '%a' ;
-- 22. 전화번호에 '.124.'이 포함된 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
	WHERE e.PHONE_NUMBER
		LIKE '%.123.%
;
-- 23. 직무 아이디가 'PU_CLERK'인 사원 중 연봉이 3000 이상인 사원들의 모든 정보를 조회한다.
SELECT * 
	FROM EMPLOYEES e
	WHERE e.JOB_ID = 'PU_CLERK'
		AND e.SALARY >= 3000
;
-- 24. 평균 연봉보다 많이 받는 사원들의 사원번호, 이름, 성, 연봉을 조회한다.
SELECT EMPLOYEE_ID,
		LAST_NAME, 
		FIRST_NAME ,
		SALARY
	FROM EMPLOYEES 
	WHERE SALARY > (SELECT AVG(SALARY)
			  FROM EMPLOYEES)
;		
-- 25. 평균 연봉보다 적게 받는 사원들의 사원번호, 연봉, 부서번호를 조회한다.
SELECT EMPLOYEE_ID,
		SALARY,
		DEPARTMENT_ID 
	FROM EMPLOYEES 
	WHERE SALARY < (
		SELECT AVG(SALARY)
		FROM EMPLOYEES)
;
-- 26. 가장 많은 연봉을 받는 사원의 사원번호, 이름, 연봉을 조회한다.
SELECT EMPLOYEE_ID,
		LAST_NAME ,
		SALARY 
	FROM EMPLOYEES 
	WHERE SALARY = (
		SELECT max(SALARY)
		FROM EMPLOYEES)
;	
-- 27. 이름이 4글자인 사원의 모든 정보를 조회한다.
SELECT *
	FROM EMPLOYEES e 
		WHERE e.LAST_NAME LIKE '____'
;
-- 28. 'SA_REP' 직무인 직원 중 가장 높은 연봉과 가장 낮은 연봉을 조회한다.
SELECT MAX(SALARY), MIN(SALARY)
FROM EMPLOYEES 
GROUP BY JOB_ID HAVING JOB_ID = 'SA_REP'
;
-- 29. 직원의 입사일자를 '연-월-일' 형태로 조회한다.
SELECT TO_CHAR(HIRE_DATE,'yyyy-mm-dd')
  FROM EMPLOYEES e
;
-- 30. 가장 늦게 입사한 사원의 모든 정보를 조회한다.
SELECT MAX(HIRE_DATE) 
FROM EMPLOYEES e
;
-- 31. 가장 일찍 입사한 사원의 모든 정보를 조회한다.
SELECT min(HIRE_DATE) 
FROM EMPLOYEES e
;
-- 32. 자신의 상사보다 더 많은 연봉을 받는 사원의 모든 정보를 조회한다
SELECT *
  FROM EMPLOYEES low
 INNER JOIN EMPLOYEES high 
    ON low.MANAGER_ID = high.EMPLOYEE_ID
 WHERE high.SALARY < low.SALARY
;
-- 33. 자신의 상사보다 더 일찍 입사한 사원의 모든 정보를 조회한다.
SELECT *
  FROM EMPLOYEES low
 INNER JOIN EMPLOYEES high 
    ON low.MANAGER_ID = high.EMPLOYEE_ID
 WHERE high.HIRE_DATE < low.hire_date
;
-- 34. 부서아이디별 평균 연봉을 조회한다.
SELECT DEPARTMENT_ID , AVG(SALARY) 
 FROM EMPLOYEES e 
 GROUP BY DEPARTMENT_ID
; 
-- 35. 직무아이디별 평균 연봉, 최고연봉, 최저연봉을 조회한다
SELECT JOB_ID , AVG(SALARY) , MAX(SALARY),MIN(SALARY)
  FROM EMPLOYEES e2 
 GROUP BY JOB_ID 
;
-- 36. 가장 많은 인센티브를 받는 사원의 모든 정보를 조회한다.
SELECT *
FROM EMPLOYEES 
WHERE COMMISSION_PCT  = (
			SELECT MAX(COMMISSION_PCT)
			FROM EMPLOYEES 
)
;
-- 37. 가장 적은 인센티브를 받는 사원의 연봉과 인센티브를 조회한다.
SELECT SALARY ,
		COMMISSION_PCT 
FROM EMPLOYEES 
WHERE COMMISSION_PCT  = (
			SELECT MIN(COMMISSION_PCT)
			FROM EMPLOYEES 
)
;
-- 38. 직무아이디별 사원의 수를 조회한다.
SELECT JOB_ID , count(1)
FROM  EMPLOYEES e 
GROUP BY JOB_ID
;
-- 39. 상사아이디별 부하직원의 수를 조회한다. 단, 부하직원이 2명 이하인 경우는 제외한다.
SELECT MANAGER_ID ,count (1)
FROM EMPLOYEES
GROUP BY MANAGER_ID HAVING count(1) > 2
;
-- 40. 사원이 속한 부서의 평균연봉보다 적게 받는 사원의 모든 정보를 조회한다.
SELECT *
FROM EMPLOYEES e 
WHERE SALARY < (
    SELECT AVG(T.SALARY)
    FROM EMPLOYEES T
    WHERE e.DEPARTMENT_ID = T.DEPARTMENT_ID
)
;
-- 41. 사원이 근무하는 부서명, 이름, 성을 조회한다.

SELECT DEPARTMENT_NAME , FIRST_NAME  , LAST_NAME 
  FROM EMPLOYEES e JOIN DEPARTMENTS d
    ON e.DEPARTMENT_ID = d.DEPARTMENT_ID 
;
-- 42. 가장 적은 연봉을 받는 사원의 부서명, 이름, 성, 연봉, 부서장사원번호를 조회한다.
SELECT d.DEPARTMENT_NAME
	 , e.FIRST_NAME
	 , e.LAST_NAME
	 , e.SALARY
	 , e.MANAGER_ID
  FROM EMPLOYEES e
  JOIN DEPARTMENTS d
    ON e.DEPARTMENT_ID = d.DEPARTMENT_ID
 WHERE e.SALARY = (SELECT MIN(e.SALARY) 
                     FROM EMPLOYEES)
;
-- 43. 상사사원번호를 중복없이 조회한다.
SELECT DISTINCT e.MANAGER_ID 
  FROM EMPLOYEES e 
 WHERE MANAGER_ID IS NOT NULL
;
-- 44. 50번 부서의 부서장의 이름, 성, 연봉을 조회한다.
SELECT e.FIRST_NAME , e.LAST_NAME , e.SALARY 
  FROM EMPLOYEES e 
 INNER JOIN DEPARTMENTS d 
    on e.EMPLOYEE_ID = d.MANAGER_ID 
 where e.DEPARTMENT_ID  =50
;
-- 45. 부서명별 사원의 수를 조회한다.
SELECT d.DEPARTMENT_NAME , COUNT(1) 
  FROM EMPLOYEES e
 INNER JOIN DEPARTMENTS d
    ON d.DEPARTMENT_ID  = e.DEPARTMENT_ID 
 GROUP BY d.DEPARTMENT_NAME
;
-- 46. 사원의 수가 가장 많은 부서명, 사원의 수를 조회한다.
SELECT *
FROM (
    SELECT d.DEPARTMENT_NAME, COUNT(e.EMPLOYEE_ID) AS counts
    FROM EMPLOYEES e
    JOIN DEPARTMENTS d 
        ON e.DEPARTMENT_ID = d.DEPARTMENT_ID
    GROUP BY d.DEPARTMENT_NAME
    ORDER BY counts DESC
)
WHERE ROWNUM <= 1
;
-- 47. 사원이 없는 부서명을 조회한다.
SELECT *
  FROM DEPARTMENTS d 
 WHERE d.DEPARTMENT_ID NOT IN (SELECT DEPARTMENT_ID
				FROM EMPLOYEES e
  				WHERE DEPARTMENT_ID IS NOT null)
;
-- 48. 직무가 변경된 사원의 모든 정보를 조회한다.
SELECT e.*
  FROM EMPLOYEES e 
  LEFT JOIN JOB_HISTORY jh 
    ON e.EMPLOYEE_ID  = jh.EMPLOYEE_ID 
 WHERE jh.EMPLOYEE_ID IS NOT NULL 
;
-- 49. 직무가 변경된적 없는 사원의 모든 정보를 조회한다.
SELECT  e.*
FROM EMPLOYEES e 
WHERE e.EMPLOYEE_ID NOT IN (SELECT jh.EMPLOYEE_ID 
			      FROM JOB_HISTORY jh)
;  
-- 50. 직무가 변경된 사원의 과거 직무명과 현재 직무명을 조회한다.
SELECT e.FIRST_NAME,
       current_job.JOB_NAME AS CURRENT_JOB_NAME,
       past_job.JOB_NAME AS PAST_JOB_NAME
FROM EMPLOYEES e
JOIN JOBS current_job
  ON e.JOB_ID = current_job.JOB_ID
LEFT JOIN JOB_HISTORY jh
  ON e.EMPLOYEE_ID = jh.EMPLOYEE_ID
LEFT JOIN JOBS past_job
  ON jh.JOB_ID = past_job.JOB_ID
WHERE jh.JOB_ID IS NOT NULL
;
-- 51. 직무가 가장 많이 변경된 부서의 이름을 조회한다.
SELECT DEPARTMENT_NAME
FROM (
    SELECT d.DEPARTMENT_NAME,
           COUNT(*) AS job_change_count
    FROM EMPLOYEES e
    JOIN DEPARTMENTS d
      ON e.DEPARTMENT_ID = d.DEPARTMENT_ID
    LEFT JOIN JOB_HISTORY jh
      ON e.EMPLOYEE_ID = jh.EMPLOYEE_ID
    WHERE jh.JOB_ID IS NOT NULL
    GROUP BY d.DEPARTMENT_NAME
    ORDER BY job_change_count DESC
)
WHERE ROWNUM = 1;
-- 52. 'Seattle' 에서 근무중인 사원의 이름, 성, 연봉, 부서명 을 조회한다.
SELECT e.FIRST_NAME 
	 , e.LAST_NAME 
	 , e.SALARY 
	 , d.DEPARTMENT_NAME 
  FROM  EMPLOYEES e 
 INNER JOIN DEPARTMENTS d 
    on e.DEPARTMENT_ID = d.DEPARTMENT_ID
 WHERE d.LOCATION_ID =(SELECT l.LOCATION_ID 
                         FROM  LOCATIONS l
                         WHERE l.CITY = 'Seattle')
;
-- 53. 'Seattle' 에서 근무하지 않는 모든 사원의 이름, 성, 연봉, 부서명, 도시를 조회한다.

SELECT e.FIRST_NAME 
	 , e.LAST_NAME 
	 , e.SALARY 
	 , d.DEPARTMENT_NAME
	 , l.CITY
  FROM  EMPLOYEES e 
 INNER JOIN DEPARTMENTS d 
    on e.DEPARTMENT_ID = d.DEPARTMENT_ID
 INNER JOIN LOCATIONS l 
 	ON d.LOCATION_ID  = l.LOCATION_ID 
 WHERE l.CITY != 'Seattle'
;
-- 54. 근무중인 사원이 가장 많은 도시와 사원의 수를 조회한다.  
SELECT *
  FROM (SELECT *
	      FROM (SELECT l.CITY , count(1) AS person
			      FROM LOCATIONS l
			      JOIN DEPARTMENTS d
			        ON l.LOCATION_ID = d.LOCATION_ID
			      JOIN EMPLOYEES e
			        ON e.DEPARTMENT_ID = d.DEPARTMENT_ID  
			     GROUP BY l.CITY ) k1
	     ORDER BY person DESC) k2		
WHERE ROWNUM = 1 
; 
-- 55. 근무중인 사원이 없는 도시를 조회한다.
SELECT l.city
FROM LOCATIONS l 
WHERE l.LOCATION_ID NOT IN (SELECT d.LOCATION_ID
			      FROM DEPARTMENTS d
			     INNER JOIN EMPLOYEES e 
			       ON d.DEPARTMENT_ID = e.DEPARTMENT_ID)						 
;
-- 56. 연봉이 7000 에서 12000 사이인 사원이 근무중인 도시를 조회한다.
SELECT l.CITY 
  FROM LOCATIONS l 
 WHERE l.LOCATION_ID in (SELECT d.LOCATION_ID
			   FROM DEPARTMENTS d 
			  WHERE d.DEPARTMENT_ID  IN (SELECT e.DEPARTMENT_ID
	                       			       FROM EMPLOYEES e	
	                       			      WHERE e.SALARY BETWEEN  7000 AND 12000))	                       
; 
-- 57. 'Seattle' 에서 근무중인 사원의 직무명을 중복없이 조회한다
SELECT e.FIRST_NAME
FROM EMPLOYEES e	
JOIN DEPARTMENTS d
ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
JOIN LOCATIONS l
ON l.LOCATION_ID = d.LOCATION_ID
WHERE l.CITY = 'Seattle'
;
-- 58. 사내의 최고연봉과 최저연봉의 차이를 조회한다
SELECT MAX(SALARY) - MIN(SALARY) AS DIFF
FROM EMPLOYEES
;
-- 59. 이름이 'Renske' 인 사원의 연봉과 같은 연봉을 받는 사원의 모든 정보를 조회한다. 단, 'Renske' 사원은 조회에서 제외한다.
SELECT *
FROM EMPLOYEES e1
WHERE e1.SALARY = (SELECT e2.SALARY
		    FROM EMPLOYEES e2
                   WHERE e2.FIRST_NAME = 'Renske')
AND e1.FIRST_NAME != 'Renske'
-- 60. 회사 전체의 평균 연봉보다 많이 받는 사원들 중 이름에 'u' 가 포함된 사원과 동일한 부서에서 근무중인 사원들의 모든 정보를 조회한다.
SELECT *
FROM EMPLOYEES e1
WHERE e1.DEPARTMENT_ID IN (SELECT e2.DEPARTMENT_ID
			    FROM EMPLOYEES e2
  			   WHERE e2.SALARY > (SELECT AVG(SALARY)
					       FROM EMPLOYEES))
			    AND e2.FIRST_NAME LIKE '%u%')
;
-- 61. 부서가 없는 국가명을 조회한다.
SELECT c.COUNTRY_NAME
  FROM COUNTRIES c 
 WHERE c.COUNTRY_ID NOT IN (SELECT l.COUNTRY_ID
			      FROM LOCATIONS l
  			      JOIN DEPARTMENTS d 
  			        ON d.LOCATION_ID = l.LOCATION_ID)
;
-- 62. 'Europe' 에서 근무중인 사원들의 모든 정보를 조회한다.
SELECT *
FROM EMPLOYEES e	
JOIN DEPARTMENTS d
ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
JOIN LOCATIONS l
ON l.LOCATION_ID = d.LOCATION_ID
JOIN REGIONS r
ON r.REGION_ID = l.REGION_ID
WHERE r.REGION_NAME = 'Europe'
;
-- 63. 'Europe' 에서 가장 많은 사원들이 있는 부서명을 조회한다.
SELECT DEPARTMENT_NAME
FROM (
    SELECT d.DEPARTMENT_NAME,
           COUNT(*) AS employee_count
    FROM EMPLOYEES e
    JOIN DEPARTMENTS d
      ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
    JOIN LOCATIONS l
      ON l.LOCATION_ID = d.LOCATION_ID
    JOIN REGIONS r
      ON r.REGION_ID = l.REGION_ID
    WHERE r.REGION_NAME = 'Europe'
    GROUP BY d.DEPARTMENT_NAME
    ORDER BY employee_count DESC
)
WHERE ROWNUM = 1;
-- 64. 대륙 별 사원의 수를 조회한다.
SELECT
FROM EMPLOYEES e
    JOIN DEPARTMENTS d
      ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
    JOIN LOCATIONS l
      ON l.LOCATION_ID = d.LOCATION_ID
    JOIN REGIONS r
      ON r.REGION_ID = l.REGION_ID
GROUP BY  r.REGION_NAME

-- 65. 연봉이 2500, 3500, 7000 이 아니며 직업이 SA_REP 이나 ST_CLERK 인 사람들을 조회한다.


 ```
